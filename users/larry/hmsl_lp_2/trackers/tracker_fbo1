\ fb-01 file for trackersanew task-tracker_fbo1\ midi parser wordob.job fb-jobv: fb-job-counterv: fb-job-length: FB-JOB.START.FUNCTION { job -- }	0 fb-job-counter !	30 10 wchoose fb-job-length !	rtc.rate@ 4 / rtc.rate@ 30 / wchoose	job	put.duration: [];: FB-JOB.FUNCTION { job -- }	#-fb-voices @ fb_channel_base +  	fb_channel_base 	wchoose midi.channel!	hex 4000 choose midi.bend decimal	1 fb-job-counter +!	fb-job-counter @ fb-job-length @ >	IF		job stop: []	ELSE		rtc.rate@ 4 / rtc.rate@ 30 / wchoose		job	put.duration: []	THEN		;	: INIT.FB-JOB	1 new: fb-job	'c fb-job.function add: fb-job	'c fb-job.start.function put.start.function: fb-job	;\ sends midi out to channels 9-16: MIDI->FB { note vel -- }	fb-trigger @ 12 =	not 	IF		note 12 mod fb-trigger @ =		IF			." triggering "			start: fb-job		THEN	THEN	#-fb-voices @ 0	DO		i fb_channel_base +  midi.channel!		note f-fb-loudness @ dup 2/ wchoose  midi.noteon		hex 2000 decimal ( center of bend )		f-fb-range @ #-fb-voices @ / 		i 1+ * dup 2/ wchoose		2/		2 choose 0= IF - ELSE + THEN		midi.bend	LOOP;: MIDI.FB.OFF { note vel -- }	#-fb-voices @ 0	DO		i fb_channel_base +  midi.channel!		midi.lastoff	LOOP;	\ when on, fill midi parser with it: CG-FB-ON.FUNCTION	true f-fb-on? !	'c midi->fb mp-on-vector !\	'c midi.fb.off mp-off-vector !	midi.parser.on;: CG-FB-OFF.FUNCTION	false f-fb-on? !	fb_channel_base 8 + fb_channel_base	DO 		i midi.channel! midi.lastoff 	LOOP	mp.reset;\ grid has range, # of voices, loudness, preset 1, preset 2: CG-FBo1.FUNCTION { val part -- }	val true =	IF		cg-fb-on.function	ELSE		cg-fb-off.function	THEN ;: BUILD.CG-FBO1	1 1 new: CG-FBO1	375 375 put.wh: CG-FBO1	9 put.text.size: CG-FBO1	'c CG-FBo1.FUNCTION put.down.function: CG-FBO1	stuff{ " fb-on? " }stuff.text: CG-FBO1	" FB " put.title: CG-FBO1;: CG-FBO1-PARAMS-FUNCTION { val part -- }	part CASE		0 OF val #-fb-voices  ! ENDOF		1 OF val f-fb-range ! ENDOF		2 OF val f-fb-loudness ! ENDOF		3 of val fb-trigger ! endof	ENDCASE;	: BUILD.CG-FBO1-Params	1 4 new: CG-FBO1-Params	250 300 put.wh: CG-FBO1-Params	9 put.text.size: CG-FBO1-Params	'c CG-FBO1-PARAMS-FUNCTION put.down.function: CG-FBO1-Params	" FBO1 " put.title: CG-FBO1-Params	1 0 put.min:   CG-FBO1-Params	0 1 put.min:   CG-FBO1-Params	30 2 put.min:   CG-FBO1-Params	0 3 put.min: cg-fbo1-params\		8 0 put.max:  CG-FBO1-Params	8172 1 put.max:  CG-FBO1-Params	128 2 put.max: CG-FBO1-Params	12 3 put.max: cg-fbo1-params\	#-fb-voices @ 0 put.value: CG-FBO1-Params	f-fb-range  @ 1 put.value: CG-FBO1-Params	f-fb-loudness @ 2 put.value: CG-FBO1-Params	fb-trigger @ 3 put.value: cg-fbo1-params\		stuff{ " #-voices " " range " " loudness " " trigger "	}stuff.text: CG-FBO1-Params;: INIT.FBO1	init.fb-job;