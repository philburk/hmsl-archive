\ Shape entry for piano study in mixed accents analysis\ author lp\ 10/19/93anew task-p_shapesob.objlist whole-pieceob.shape s-whole-pieceob.objlist all-groupsob.objlist section-1ob.objlist section-2ob.objlist section-3ob.objlist section-4ob.objlist section-5ob.elmnts p-notesob.elmnts p-intervalsob.elmnts p-tritone-intervals	: INIT.WHOLE-PIECE	700 2 new: s-whole-piece	5 new: whole-piece	200 new: all-groups	section-1 add: whole-piece	section-2 add: whole-piece	section-3 add: whole-piece	section-4 add: whole-piece	section-5 add: whole-piece;: INIT.SECTIONS	12 new: section-1	15 new: section-2	57 new: section-3	15 new: section-4	12 new: section-5;: MAKE.SHAPES { | curr-section -- }	5 0 DO		i get: whole-piece		-> curr-section		curr-section max.elements: [] 0 		DO			instantiate ob.m.shape 			curr-section			add: []		LOOP	LOOP;: NEW.SHAPES { | curr-section curr-group -- }	\ section 5 lengths	5 5 5 5 3 6 4 5 4 4 5 2	\ section 4 lengths	6 4 5 5 3 6 4 5 4 3 2 4 5 5 7	\ section 3 lengths	6 5 5 5 3 6 4 5 4 3 5 2 6 4 6 	5 5 4 6 5 3 3 4 5 5 4 5  4 3 8	5 4 5 5 4 3 3 5 6 4 5 5 6 4 6 	2 5 3 4 5 4 6 3 5 5 5 6	\ section 2 lengths	7 5 5 4 2 3 4 5 4 6 3 5 5 4 6	\ section 1 lengths	2 5 4 4 5 4 6 3 5 5 5 6	5 0 DO		." . "		i get: whole-piece		-> curr-section		curr-section many: []  0		DO			2 ( dimensions )			i curr-section at: []			new: []			 i curr-section at: [] -> curr-group			1 curr-group put.curr-dim: []			'c mw.unity curr-group put.linear.weight.function: []			'c mw.unity curr-group put.row.weight.function: []				'c mw.unity curr-group put.column.weight.function: []			LOOP	LOOP	cr;: INIT.ALL-GROUPS { | curr-section -- }	." Initializing all groups " 	5 0 DO		i get: whole-piece		-> curr-section		curr-section many: []  0		DO			i at: curr-section			add: all-groups		LOOP	LOOP	cr;	: PRINT.MANYS { | curr-section curr-shape -- }	cr	many: whole-piece 0 	DO		i  		dup ." Section " . tab		at: whole-piece		-> curr-section 		curr-section many: [] 0		DO			i  curr-section at: []			-> curr-shape			curr-shape max.elements: [] .		LOOP		cr	LOOP;: INIT.P-ARRAYS	12 5 new: p-notes	12 5 new: p-intervals	7 5 new: p-tritone-intervals	12 0 DO		0 0 0 0 0 add: p-notes		0 0 0 0 0 add: p-intervals	LOOP	7 0 DO		0 0 0 0 0  add: p-tritone-intervals	LOOP;