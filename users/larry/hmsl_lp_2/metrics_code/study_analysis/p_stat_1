\ statistical measures on notes alone\ piano study in mixed accentsanew task-pstat_1\ Length of groups, sections, piece: P.TOTAL.NOTES	." Total number of notes in the whole piece = " 	many: s-whole-piece .	cr;: P.PRINT.WHOLE.PIECE { | temp-int temp-sum -- }	0 -> temp-sum 	cr	." Notes in the whole piece, intervals, tritone-intervals' " cr	many: s-whole-piece 0 DO		i . tab		i 1 ed.at: s-whole-piece		. tab		i 0 > IF		\ non tritone equivalent interval			i 1 ed.at: s-whole-piece			i 1- 1 ed.at: s-whole-piece			- abs dup . tab			temp-sum + -> temp-sum 		\  tritone equivalent interval			i 1 ed.at: s-whole-piece			i 1- 1 ed.at: s-whole-piece			- abs dup			5 > IF				12 swap - abs .			ELSE				.			THEN			tab		THEN		cr	LOOP	1 calc.dim.stats: s-whole-piece	1 get.dim.mean: s-whole-piece	." Mean pitch of piece is: " . cr	." Mean interval of piece is: " 	temp-sum float many: s-whole-piece 1- float f/ f. cr	1 get.dim.max: s-whole-piece	." High pitch of piece is: " dup . cr	1 get.dim.min: s-whole-piece	." Low pitch of piece is: "  dup . cr	- 	." Range of piece is: " . cr	;\ simple utility for searching for the next occurrence of a given value\ leaves a -1 if no match is found...\ example: 3 5 foo search.and.match starts at value 3 in dimension 5...\ this is a routine that's based on a new_shape method: SEARCH.AND.MATCH { t-ind t-dim t-last-ind t-shape | t-val -- new-index }	-1	t-ind t-dim t-shape ed.at: [] 	12 mod -> t-val	t-last-ind t-ind 1+ DO		i t-dim t-shape ed.at: [] 		12 mod 		t-val = 		IF 					drop i LEAVE 		THEN	LOOP; : NOTE.REPEAT {  -- }	cr	many: s-whole-piece 0 DO		i 1 many: s-whole-piece s-whole-piece search.and.match		dup . 		dup -1 =		IF drop LEAVE 		ELSE			tab tab	i - abs  . cr		THEN	LOOP;	\ 54 68 261 68 53: NOTE.REPEAT.SECTION { first-note last-note -- }	last-note first-note DO		i 1 last-note s-whole-piece search.and.match		dup -1 =		IF drop LEAVE 		ELSE			tab tab	i - abs  . cr		THEN	LOOP;	: SECTION.REPEATS	cr ." Section 1 " cr	0 54 note.repeat.section	cr ." Section 2 " cr	54 122 note.repeat.section	cr ." Section 3 " cr	122 383 note.repeat.section	cr ." Section 4 " cr	383 451 note.repeat.section	cr ." Section 5 " cr	451 many: s-whole-piece note.repeat.section;			: P.#.NOTES { | t-sum curr-section -- }	cr	." Number of notes in each group " cr	many: whole-piece 0	DO		cr i ." Section # : " . cr 		i at: whole-piece -> curr-section		curr-section many: [] 0 		DO			i curr-section at: []			many: [] . cr		LOOP		cr	LOOP;: P.#.NOTES.SECTIONS { | t-sum curr-section curr-group -- }	cr	." Number of notes, average for each group, in each section "		many: whole-piece 0	DO		0 -> t-sum		cr i ." Section # : " . tab		i at: whole-piece -> curr-section		curr-section many: [] 0 		DO			i curr-section at: []			many: [] 			t-sum + -> t-sum		LOOP		t-sum .		t-sum float curr-section many: [] float f/ f.		tab 		cr	LOOP;	: MEAN.RANGE.SD.NOTES { |  curr-section curr-group -- }		cr	." Mean, range, max, min, sd for each group " cr	many: whole-piece 0	DO		cr i ." Section # : " . cr		i at: whole-piece -> curr-section		curr-section many: [] 0 		DO			i curr-section at: []			-> curr-group			1 curr-group calc.dim.stats: []			1 curr-group calc.extended.stats: []			1 curr-group dim.fmean: [] f. tab tab			1 curr-group get.dim.max: [] dup . tab  tab			1 curr-group get.dim.min: [] dup . 			- . tab tab			1 curr-group get.dim.sd: []  f. cr		LOOP		cr	LOOP;fvariable t-sdfvariable t-fmean: MEAN.RANGE.SD.NOTES.SECTIONS { |  curr-section curr-group temp-range -- }		cr	." Mean, average range, average sd for each section " cr	many: whole-piece 0	DO		cr i ." Section # : " . cr				i at: whole-piece -> curr-section		0 -> temp-range		0.0 t-sd f!		0.0 t-fmean f!		curr-section many: [] 0 		DO			i curr-section at: []			-> curr-group			1 curr-group calc.dim.stats: []					1 curr-group dim.fmean: [] t-fmean f@ f+   t-fmean f!			1 curr-group get.dim.max: []			1 curr-group get.dim.min: [] - temp-range + -> temp-range			1 curr-group get.dim.sd: []  t-sd f@ f+ t-sd f!		LOOP		t-fmean f@  curr-section many: [] float f/ f. tab tab		temp-range float curr-section many: [] float f/ f. tab tab 		t-sd f@ curr-section many: [] float f/ f.		cr	LOOP;: DO.STAT.1\	P.TOTAL.NOTES		." ********************************* " cr\		P.PRINT.WHOLE.PIECE		." ********************************* " cr\		P.#.NOTES		." ********************************* " cr		P.#.NOTES.SECTIONS 		." ********************************* " cr		MEAN.RANGE.SD.NOTES		." ********************************* " cr		MEAN.RANGE.SD.NOTES.SECTIONS ;