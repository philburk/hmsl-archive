\ ICMC Melodic demosinclude? task-midifile ht:midifileinclude? task-score_entry ht:score_entryinclude metrics:load_metricsanew task-icmc_melody_demosob.mutant i-randomob.mutant i-monkob.mutant i-teddyob.mutant i-januaryob.mutant i-temp\ these are the three lists for each demoob.mutantlist i-list-1ob.mutantlist i-list-2ob.mutantlist i-list-3ob.player i-player-1ob.player i-player-2ob.player player-teddyob.player player-monkob.player player-januaryob.player player-randomscore{48 TICKS/BEAT !96 rtc.rate!: SETUP.TEMPO  ( -- , for proper note durations )	ticks/beat @ 4* tpw!;\ i-random is a random pitch sequence between 60 and 90\ there are two demos here, the third is some extract of the guitar piece...\ Demo I: Random pitch melody -> eigth of january via a concatenated LCM/IUIM\ 5 stages: INIT.JANUARY	1 new: i-player-1	0 put.offset: ins-midi-1	29 4 new: i-january	i-january ins-midi-1 build: i-player-1	3 put.on.dim: i-player-1	i-january ins-midi-1	shapei{	120 staccato!	EH d4 e F# e f# a f# e Q d	EH  e F# e d Q b3	EH b3 d4 e d e F# e d b3 a d4 e d b3 W d4		  	}shapei	1 put.curr-dim: i-january\ accent first note of melody	120 0 2 ed.to: i-january	use.fund-index: i-january	0 put.fund-index: i-january	zero-override?.on: i-january;: INIT.RANDOM	0 put.offset: ins-midi-1	29 4 new: i-random	29 4 new: i-temp	i-random ins-midi-1 build: i-player-1	3 put.on.dim: i-player-1	29 0 DO 		i 0 ed.at: i-january \ get duration		70 42 wchoose \ pitch		80 		i 3 ed.at: i-january 		add: i-random	LOOP	1 put.curr-dim: i-random	1 put.curr-dim: i-temp\ accent first note of melody	120 0 2 ed.to: i-random	0 1 ed.at: i-january	0 1 ed.to: i-random	use.fund-index: i-random	use.fund-index: i-temp	0 put.fund-index: i-temp	0 put.fund-index: i-random	i-temp clone: i-random	zero-override?.on: i-random	zero-override?.on: i-temp;: SWING.EIGTH	5 choose	case		0 of 1 24 duration!! endof		1 of 1 21 duration!! endof		2 of 1 26 duration!! endof		3 of 1 28 duration!! endof		4 of 1 19 duration!! endof	endcase	tie eh;: INIT.MONK	1 new: i-player-2	0 put.offset: ins-midi-2	50 4 new: i-monk	i-monk ins-midi-2 build: i-player-2	3 put.on.dim: i-player-2	i-monk ins-midi-2	shapei{	129 staccato!	swing.eigth tie s3 96 loudness! 	eh d5 80 loudness! swing.eigth d#  e h tie q f	swing.eigth tie s 96 loudness! g 	swing.eigth 80 loudness! g#  a h tie q  a#\	swing.eigth tie s3 96 loudness! f 	swing.eigth 80 loudness! g f e d# f4 c#5 1 17 duration!! tie  q.  d	swing.eigth  c# h tie eh c	swing.eigth tie s3 96 loudness! g 	swing.eigth 80 loudness! g# a h tie q  a#	swing.eigth tie s3 a# b c6 h tie q  c#	swing.eigth tie s3 96 loudness! f5 	swing.eigth 80 loudness! g f e d# f4 c#5 	eh tie h d	q rest	1 24 duration!! e6 eh3 tie s f6 	1 24 duration!! e6 eh3 tie s f6 	1 24 duration!! e6 eh3 tie s f6	eh tie s. f q. tie s. tie h f5	swing.eigth tie s3 	96 loudness! f5 	swing.eigth 80 loudness! g f e d# f4 c#5 	s tie 2/1 d	}shapei	1 put.curr-dim: i-monk\ accent first note of melody	120 0 2 ed.to: i-monk	use.adjacent: i-monk	zero-override?.on: i-monk;: INIT.TEDDY	1 new: i-player-2	0 put.offset: ins-midi-2	50 4 new: i-teddy	i-teddy ins-midi-2 build: i-player-2	3 put.on.dim: i-player-2	i-teddy ins-midi-2	shapei{		129 staccato!		eh d4		q g eh a#  a a# a q g eh a# q a		eh a# g a a# q a eh. a# h tie q g		eh g		q a# eh d5  c d c q a#4 eh d5 q c5		eh d5 a#4 c5 d5 q c5 eh d5 h tie q a#4		eh f5 q g eh f q g eh f d d# f q d		eh c q c eh a#4 q c5 eh a#4 g a a# q tie h g	}shapei	1 put.curr-dim: i-teddy\ accent first note of melody	96 0 2 ed.to: i-teddy	use.adjacent: i-teddy	zero-override?.on: i-teddy;: I-LIST-1.INIT { mutant -- }	29 4 mutant new: []	1 mutant put.curr-dim: []	mutant use.fund-index: []	0 mutant put.fund-index: []	mutant clone: i-random	i-random mutant put.source-shape: []	i-january mutant put.target-shape: []	0 mutant put.: []	mutant zero-override?.on: [];: I-LIST-2.INIT { mutant -- }	50 4 mutant new: []	1 mutant put.curr-dim: []	mutant use.adjacent: []	mutant clone: i-teddy	i-teddy mutant put.source-shape: []	i-monk mutant put.target-shape: []	0 mutant put.: []	mutant zero-override?.on: [];: I-MUTANT-LIST-1.FILL\ first fill the two lists...	5  new: i-list-1	cr ." Filling mutant list 1 " 	5 0 	DO			." . "		instantiate ob.mutant		add: i-list-1	LOOP;: I-MUTANT-LIST-2.FILL	6 new: i-list-2	cr ." Filling mutant list 1 "	6 0 	DO			." . "		instantiate ob.mutant		add: i-list-2	LOOP;\ now initialize each mutant: I-MUTANT-LIST-1.INIT	i-mutant-list-1.fill	." Initializing list 1 "	'c i-list-1.init do: i-list-1  ;: I-MUTANT-LIST-2.INIT	i-mutant-list-2.fill	." Initializing list 2 "	'c i-list-2.init do: i-list-2 ;: I-PLAYER-1.INIT	6 1+ new: i-player-1 ( room for original as well.... )	3 put.on.dim: i-player-1	ins-midi-1 put.instrument: i-player-1\	i-random add: i-player-1	." adding mutants to player 1 now " cr\	5 0 	DO		." . "		i at: i-list-1		add: i-player-1	LOOP;	: I-PLAYER-2.INIT			6 1+ new: i-player-2	3 put.on.dim: i-player-2	ins-midi-2 put.instrument: i-player-2	i-teddy add: i-player-2	." adding mutants to player 2 now " cr	6 0 	DO		." . "		i at: i-list-2		add: i-player-2	LOOP;}score: MUTATE.I-LIST-1 { | list mutant  -- }		." List 1 " cr		i-list-1 -> list		5 0 DO				i-temp clone: i-random				i at: i-list-1				-> mutant				i-january mutant put.target: []				i-random put.source: i-temp				i-january put.target: i-temp				1000 5 / i 1+ * 				." mutation degree is " dup . cr				0 1000 clipto dup				mutant put.: []				put.: i-temp				iuim: i-temp				i-temp mutant put.source: []				mutant lcm: []		LOOP	;: MUTATE.I-LIST-2.PITCHES { | list mutant  -- }		." List 2 pitches " cr		i-list-2 -> list\ first do a two stage mutation on the pitch\ first a contour mutation, and then a UUIM	1 put.curr-dim: i-teddy	1 put.curr-dim: i-monk		3 0 DO			i at: i-list-2			-> mutant			1 mutant put.curr-dim: []			i-teddy mutant put.source: []			i-monk mutant put.target: []			1000 3 / i 1+ * 			0 1000 clipto			mutant put.: []			mutant lcm: []		LOOP		i-temp mutant clone: []		3 0 DO			i 3 + at: i-list-2			-> mutant			1 put.curr-dim: i-temp			1 mutant put.curr-dim: []			i-temp mutant put.source: []			i-monk mutant put.target: []			1000 3 / i 1+ * 			0 1000 clipto			mutant put.: []			mutant iuim: []		LOOP;: MUTATE.I-LIST-2.DURATIONS { | list mutant  -- }	." List 2 durations " cr	i-list-2 -> list	\ now do durations	0 put.curr-dim: i-teddy	0 put.curr-dim: i-monk	6 0 DO		i at: i-list-2		-> mutant		i-teddy mutant put.source: []		i-monk mutant put.target: []		0 mutant put.curr-dim: []		1000 6 / i 1+ * 		dup 950 > IF drop 1000 THEN		0 1000 clipto		mutant put.: []		mutant usim: []	LOOP;: MUTATE.I-LIST-2.LOUDNESS { | list mutant  -- }	." List 2 loudness " cr	i-list-2 -> list	\ now do amplitudes	2 put.curr-dim: i-teddy	2 put.curr-dim: i-monk	6 0 DO			i at: i-list-2			-> mutant			i-teddy mutant put.source: []			i-monk mutant put.target: []			2 mutant put.curr-dim: []			1000 6 / i 1+ * 			dup 950 > IF drop 1000 THEN			0 1000 clipto			mutant put.: []			mutant usim: []	LOOP;: MUTATE.I-LIST-2	mutate.i-list-2.pitches	mutate.i-list-2.durations\	mutate.i-list-2.loudness;: INIT.ICMC.DEMO.1	init.january	init.random	I-MUTANT-LIST-1.INIT	i-player-1.init	mutate.i-list-1;: INIT.ICMC.DEMO.2	init.monk ." monk init " cr	init.teddy ." teddy init " cr 	i-mutant-list-2.init ." lists init " cr 	i-player-2.init ." player init " cr 	mutate.i-list-2 ." mutated " cr;	: INIT.MELODIES	1 new: player-teddy	1 new: player-monk	1 new: player-random	1 new: player-january	3 put.on.dim: player-teddy	ins-midi-1 put.instrument: player-teddy	i-teddy add: player-teddy\	3 put.on.dim: player-monk	ins-midi-1 put.instrument: player-monk	i-monk add: player-monk	3 put.on.dim: player-january	ins-midi-1 put.instrument: player-january	i-january add: player-january	3 put.on.dim: player-random	ins-midi-1 put.instrument: player-random	i-random add: player-random;		: TERM.ICMC.DEMOS	freeall: i-list-1	freeall: i-list-2	free: i-january	free: i-random	free: i-teddy	free: i-monk	free: i-player-1	free: i-player-2	free: i-temp;: DO.ICMC.DEMO.1	init.icmc.demo.1	i-player-1 hmsl.play\	term.icmc.demos;: DO.ICMC.DEMO.2	120 rtc.rate!	init.icmc.demo.2	i-player-2 hmsl.play\	term.icmc.demos;: DO.ICMC.DEMO.1.FINALE	setup.tempo	" metrics:icmc.demo.1 "	$midifile0{ 	do.icmc.demo.1	}midifile0;	if.forgotten term.icmc.demos