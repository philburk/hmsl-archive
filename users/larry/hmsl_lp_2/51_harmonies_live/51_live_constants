\ 51 live constantsanew task-51_live_constants\ set this differently to hear different versions of the piece13 rand-seed !\ set buffer75 time-advance !\ these are recomputed at init time, but these are dummy valu11 mooes, which\ should be the same206 value #-of-shapes677 value #-of-notes\ maximum number of shapes in any one section11 value max-shapes: FIXROUND ( float -- roundfix )	fdup fdup \ float float float	f>i float \ float float fix	f-  \ float fract-part	.5 f>	IF		1.0 f+		f>i	ELSE		f>i	THEN;: MM->PULSE { mm -- pulse }	rtc.rate@ float	60.0 f*	mm float f/	fixround;	60 rtc.rate!	345 value mm-markingmm-marking mm->pulse value arp-pulse\ repeats1000 value #-of-repeats\ variables for control of piecev: curr-section \ 0 curr-section !v: next-section?1 value vol-pedal?v: collection-time \ total time of the collection, used by some voices0 value triangle-value \ this goes from 0 to 25 and then down, as section ranges\ computed each section time, so don't have to keep computing it...\ variables to assign midi channels to different playing objects6 value #-voices10 value #-presets\ array for turning on and off voicesob.array voices-on?\ array for scaling loudnessesob.array voice-loudness\ now define preset lists for each voiceob.shape 51-presets\ array for typing in #-of-repeats to pieceob.array repeat-array\ now define objects, so that they can be used after thisob.collection 51-live-collob.player arp-playerob.player chord-playerob.player accent-playerob.player perc-playerob.job melody-1-jobob.job melody-2-job\ controls, so that they can be accessed laterob.screen 51-screenob.numeric.grid cg-arp-pulseob.check.grid cg-voices-onob.numeric.grid cg-voice-presetsob.numeric.grid cg-voice-loudness\ constants for note names for entering arpeggios60 k: c61 k: c# 	61 k: db62 k: d63 k: d# 	63 k: eb64 k: e65 k: f66 k: f#	66 k: gb67 k: g68 k: g#	68 k: ab69 k: a70 k: a#	70 k: bb71 k: b		71 k: cb\ constants for channels and indices for different voices0 k: perc1 k: arp2 k: accent3 k: chord4 k: mel-15 k: mel-2: DRAW.VOICES.ON	\ this draw should happen as the last thing in the parralel collection	\ the following kluge is necessary, because it will otherwise try to draw it	\ before the window is opened	curr-section @ 0 >	IF			draw: cg-voices-on	THEN;: INIT.VOICES	." Initializing voice data " cr	#-voices new: voices-on?	#-voices new: voice-loudness	#-voices 0 	DO		true i to: voices-on?		85 i to: voice-loudness	LOOP	100 arp to: voice-loudness;: PRINT.CHANNELS	cr cr	tab ." perc channel is " perc 1+ . 	tab ." arp channel is " arp 1+ . cr 	tab ." accent channel is " accent 1+ . 	tab ." chord channel is " chord 1+ . cr	tab ." mel 1 channel is " mel-1 1+ . 	tab ." mel 2 channel is " mel-2 1+ . cr ;: INIT.REPEAT-ARRAY	51 new: repeat-array	51 0 DO		#-of-repeats i to: repeat-array	LOOP;: GET.NUMBER.REPEATS	curr-section @ at: repeat-array;: INIT.51-PRESETS	#-voices #-presets new: 51-presets	#-voices set.many: 51-presets	\ arp channel presets	\ adds presets 24-28	1  2 2 3 3 3 4 6 6 7  	#-presets 0 	DO		 arp i ed.to: 51-presets	LOOP	\ now add chord possible presets, this is on the fbo1, midi channel 4, bank 1	3 5 10 19 20 21 25 30 31 35 	#-presets 0 	DO		 chord i ed.to: 51-presets	LOOP	\ now add accent possible presets: channel 2 of the fb01, bank 3	3 10 11 20 25 31 32 34 41 42 	#-presets 0 	DO		accent i ed.to: 51-presets	LOOP	\ these are all kits on the Yamaha RM70	4 10 14 26 51 51 53 51 4 61	#-presets 0 	DO		perc i ed.to: 51-presets	LOOP	1 2 3 3 4 4 5 6 7 8	#-presets 0 	DO		mel-1 i ed.to: 51-presets	LOOP	1 2 3 4 5 6 4 5 6 4 \ these are presets on the second akai	#-presets 0 	DO		mel-2 i ed.to: 51-presets	LOOP;: INIT.51-CONSTANTS	init.51-presets tab 	init.voices 	init.repeat-array;: TERM.51-CONSTANTS	free: 51-presets	free: voices-on?	free: voice-loudness;if.forgotten term.51-constants