\ 51 live, accents...anew task-51_live_accents\ ob.player chord-player is defined in constantsob.instrument accent-instrumentv: accent-repeat-flagv: accent-first-notev: accents-on?v: accent-transpose-factorv: accent-drop-out-factor: ACCENT-PLAYER-START.FUNC { player | coll -- } 	\ pick possibility of accent not playing for section	triangle-value  	25 choose < 	IF		true accent to: voices-on?		1 accent put.value: cg-voices-on	ELSE		false accent to: voices-on?		0 accent put.value: cg-voices-on	THEN	0 accent-first-note !	\ first set preset for this section	accent 1+ midi.channel!	accent #-presets choose 	ed.at: 51-presets midi.preset	\ now get the current collection, and add the shapes to this player	curr-section @ 	at: collection-list	-> coll	coll many: []	player set.many: []	many: coll 0 DO		i coll at: []		i player put: []	LOOP	\ pick a random octave, and select a drop out factor	5 choose 2 - accent-transpose-factor ! ;: ACCENT-PLAYER-REPEAT.FUNC { player | coll -- }	0 accent-repeat-flag !	0 accent-first-note !;		: ACCENT-PLAYER-DUR.FUNC { el shape -- }	arp-pulse;: INIT.ACCENT-PLAYER	max-shapes new: accent-player	1 put.repeat: accent-player	accent-instrument put.instrument: accent-player	'c accent-player-dur.func put.dur.function: accent-player	'c accent-player-start.func put.start.function: accent-player	'c accent-player-repeat.func put.repeat.function: accent-player;: ACCENT.VEL { el shape  -- }	\ if arps is turned off, set all velocities to be zero	accent at: voices-on?	IF		127		dup		curr-section @ at: collection-lengths / 		 shape get.data: [] * \ 0-127 		- \ 127 - range		dup 3 * 5 / 		wchoose 		accent at: voice-loudness 100 */	ELSE		0	THEN;: ACCENT-INSTRUMENT.FUNC {  el shape ins | dur -- }	ins get.channel: []  midi.channel!	midi.lastoff	\ only play on first note of each shape, and if shape is big enough	shape many: [] 1 >	el 0= and	IF		\ first pick duration of accent		shape many: [] 1+ 1 wchoose 2 min arp-pulse * -> dur		el shape at: [] accent-transpose-factor @ 12 * + 		el shape accent.vel dur midi.noteon.for		1 accent-first-note ! \ set for purposes of velocity	THEN	;	: INIT.ACCENT-INSTRUMENT	0 put.offset: accent-instrument	accent 1+ put.channel: accent-instrument	'c accent-instrument.func put.on.function: accent-instrument;: INIT.ACCENTS	init.accent-player	init.accent-instrument;: TERM.ACCENTS	free: accent-player	free: accent-instrument;