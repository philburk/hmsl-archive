\ Metric arrays for rcs....anew task-c_metric_arraysob.shape rcs-metrics-1ob.shape rcs-metrics-2ob.shape rcs-metrics-3ob.shape rcs-metrics-4ob.shape rcs-metrics-5ob.objlist rcs-metric-listfvariable alphafvariable beta0.5 beta f!0.5 alpha f!: INIT.RCS-METRICS { |  curr-section curr-metrics -- }	5 new: rcs-metric-list	rcs-metrics-1 add: rcs-metric-list	rcs-metrics-2 add: rcs-metric-list	rcs-metrics-3 add: rcs-metric-list		rcs-metrics-4 add: rcs-metric-list	rcs-metrics-5 add: rcs-metric-list	many: rcs-metric-list 0 DO		i at: rcs-metric-list		-> curr-metrics		i at: whole-piece		-> curr-section		curr-section many: [] 11 		curr-metrics new: []		" UCM>1st " 0 curr-metrics put.dim.name: []		" UCM>adj " 1 curr-metrics put.dim.name: []		" UCM>last " 2 curr-metrics put.dim.name: []		" UCD>1st " 3 curr-metrics put.dim.name: []		" UCD>adj " 4 curr-metrics put.dim.name: []		" UCD>last " 5 curr-metrics put.dim.name: []		" 1stavg " 6 curr-metrics put.dim.name: []		" adjavg " 7 curr-metrics put.dim.name: []		" lastavg " 8 curr-metrics put.dim.name: []		" low note " 9 curr-metrics put.dim.name: []		" high note " 10 curr-metrics put.dim.name: []	LOOP	many: rcs-metric-list 0 DO		i at: rcs-metric-list		-> curr-metrics		curr-metrics max.elements: [] 0 DO			0 0 0 0 0 0 0 0 0 0 0 curr-metrics add: []		LOOP	LOOP;: SET.UNITY { | curr-group -- }	many: all-groups 0 DO		i at: all-groups -> curr-group		'c mw.unity curr-group put.linear.weight.function: []		'c mw.unity curr-group put.row.weight.function: []		'c mw.unity curr-group put.column.weight.function: []	LOOP;: SET.1/i { | curr-group -- }	many: all-groups 0 DO		i at: all-groups -> curr-group		'c mw.1/i curr-group put.linear.weight.function: []		'c mw.1/i curr-group put.row.weight.function: []		'c mw.1/i curr-group put.column.weight.function: []	LOOP;: FILL.RCS-METRICS { |  curr-section  curr-group curr-metric-list first-group prev-group last-group -- }	cr ." Metric intervals to first and last group, sections..."	." 1/i weight function " 		set.1/i	many: whole-piece 0	DO		cr i ." Section # : " . cr 		i at: whole-piece -> curr-section		i at: rcs-metric-list -> curr-metric-list		curr-section many: [] 0 		DO			i curr-section at: [] -> curr-group			0 curr-section at: []  -> first-group			curr-section many: [] 1- curr-section at: [] -> last-group			i 1- 0 max curr-section at: [] -> prev-group\ take the metrics			\ UCM>first			curr-group first-group ucm: []  			fdup 			1000.0 f* fix			i 0 curr-metric-list ed.to: []						\ UCD>first			curr-group first-group ucd: []  			fdup			1000.0 f* fix			i 3 curr-metric-list ed.to: []						\ firstavg 			alpha f@ f* fswap beta f@ f*			f+ alpha f@ beta f@ f+ f/ 			1000.0 f* fix			i 6 curr-metric-list ed.to: []						\ UCM>last 			curr-group last-group ucm: [] 			fdup			1000.0 f* fix			i 1 curr-metric-list ed.to: []						\ UCD>last 			curr-group last-group ucd: [] 			fdup			1000.0 f* fix			i 4 curr-metric-list ed.to: []						\ lastavg 			alpha f@ f* fswap beta f@ f*			f+ 	 alpha f@ beta f@ f+ f/ 			1000.0 f* fix			i 7 curr-metric-list ed.to: []							\ ucm adj				curr-group prev-group ucm: [] 			fdup			1000.0 f* fix			i 2 curr-metric-list ed.to: []							\ ucd adj			curr-group prev-group ucd: [] 			fdup			1000.0 f* fix			i 5 curr-metric-list ed.to: []							\ adj avg.			alpha f@ f* fswap beta f@ f*			f+ alpha f@ beta f@ f+ f/ 			1000.0 f* fix			i 8 curr-metric-list ed.to: []										\ now put in ranges			\ the range of the middle group is expanded more than the range of the			\ outer groups... that is what the next bit of code does...			1 curr-group calc.dim.stats: []			1 curr-group get.dim.min: [] 			3 j 2 - abs -  2* - ( stretch the min and max as moving towards the middle section )			i 9 curr-metric-list ed.to: []			1 curr-group get.dim.max: []			( i.e max is bigger, min is smaller, from middle section outward )			 3 j 2 - abs - 2* +			i 10 curr-metric-list ed.to: []		LOOP	LOOP;: INIT.CASTEN-METRICS	init.rcs-metrics ." RCS-Metrics initialized " cr	fill.rcs-metrics ." RCS-Metrics filled " cr;init.casten-metrics : TERM.RCS-METRICS	freeall: rcs-metric-list	free: rcs-metric-list;		if.forgotten term.rcs-metrics