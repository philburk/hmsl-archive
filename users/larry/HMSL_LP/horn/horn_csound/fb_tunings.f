\ HORN\ composer: Larry Polansky\ 2/3/90ANEW TASK-FB_TUNINGS\ Tuning file, sets up SHAPES with FBO1 tunings in themV: FUNDAMENTAL-FB 	\ set in horn_tunings.f to decide keyV: CENTS-OFFSET-FB	\ used in this code to set up FB01 fractions( SHAPES which FB01 tuning information ... )ob.shape FB-1-SERIESob.shape FB-5-SERIESob.shape FB-3-SERIES: ALLOC.FB.TUNINGS ( Ñ )	17 3 new: fb-1-series 		( n f cents )		1 put.data: fb-1-series	17 3 new: fb-5-series		5 put.data: fb-5-series	17 3 new: fb-3-series		3 put.data: fb-3-series;: FREE.FB.TUNINGS ( Ñ- )	free: fb-1-series 	free: fb-5-series	free: fb-3-series;: RATIO->CENTS  ( numerator denominator -- cents )\ Equation:  cents = int(ln(float(nm)/float(dn)) /\                        ln(2.0) * 1200.00 + 0.5)    float float fswap f/    flog  2 float flog  f/    1200.0  f*    0.5 f+    int;: RATIO->NF ( num den -- note fraction cents )	ratio->cents ( -- cents )	fundamental-fb @ 100 * 	cents-offset-fb @ + ( cents value of fundamental )	+ ( -- new cents value )	dup ( -- cents cents )	fb.cents->nf ( -- cents n f )	rot  ( Ñ- n f cents );: FILL.FB-1-SERIES	17 set.many: fb-1-series	17 0 DO		i 1+		1 ratio->nf ( --   n f cents )	( fill shape in harmonic series order )	i put: fb-1-series	LOOP	" FBO1 Value " 0 put.dim.name: FB-1-SERIES	" FBO1 Fraction " 1 put.dim.name: FB-1-SERIES	" Cents " 2 put.dim.name: FB-1-SERIES;: FILL.FB-3-SERIES	fundamental-fb @	dup 7 + fundamental-fb !	2 cents-offset-fb !	17 set.many: FB-3-SERIES	17 0 DO		i 1+		1 ratio->nf ( --  n f cents )	( fill shape in harmonic series order )	i put: FB-3-SERIES	LOOP	" FBO1 Value " 0 put.dim.name: FB-3-SERIES	" FBO1 Fraction " 1 put.dim.name: FB-3-SERIES	" Cents " 2 put.dim.name: FB-3-SERIES	fundamental-fb !;: FILL.FB-5-SERIES	fundamental-fb @	dup 3 + fundamental-fb !	86 cents-offset-fb !	17 set.many: FB-5-SERIES	17 0 DO		i 1+		1 ratio->nf ( --  n f cents )	( fill shape in harmonic series order )	i put: FB-5-SERIES	LOOP	" FBO1 Value " 0 put.dim.name: FB-5-SERIES	" FBO1 Fraction " 1 put.dim.name: FB-5-SERIES	" Cents " 2 put.dim.name: FB-3-SERIES	fundamental-fb !;: FILL.FB.TUNINGS	fill.fb-1-series	fill.fb-3-series	fill.fb-5-series;: INIT.FB.TUNINGS	." Initializing FB tunings " cr	alloc.fb.tunings	fill.fb.tunings;: TERM.FB.TUNINGS	free.fb.tunings;OB.MIDI.INSTRUMENT FB-INSTRUMENT \ standard instrument for sending FB( value fraction cents )\ test interpreter for instruments: FB.INTERPRET { el# shape inst -- }	el#  shape  get: []	drop ( drop cents values )	60 fb.start.events fb.fract.on	drop	fb.stop.events;: INIT.FB-INSTRUMENT	'c fb.interpret put.on.function: fb-instrument	0 put.offset: fb-instrument;if.forgotten term.fb.tunings