\ HORN\ composer: Larry Polansky\ 2/3/90\\ 10/16/92  RDG  begin port to Mac/AudioMedia\ Tuning file, sets up SHAPES which are filled with tuning information for\ both the DSP and the FB01 from dsp_tunings.f and fb_tunings.fANEW TASK-HORN_TUNINGS\ These variables are defined in fb_tunings.f and dsp_tunings.f respectively\ As you can probably tell, they determine the fundamental for the tuning\ of their associated instruments.58 k: french_hornV: FUNDAMENTAL-HZ 		\ is set later to determine key 34 FUNDAMENTAL-FB ! \ double low Bbfrench_horn FUNDAMENTAL-HZ !  \ double low Bb\ SHAPES which contain combined tuning information ob.shape 1-SERIESob.shape 5-SERIESob.shape 3-SERIES\ SHAPES which contain harmonic series ob.shape DSP-1-SERIESob.shape DSP-5-SERIESob.shape DSP-3-SERIES: ALLOC.HORN.TUNINGS ( Ñ )	17 4 new: 1-series 			( freq note fract cents )		1 put.data: 1-series	\ currently cents is unused in the piece	17 4 new: 5-series			\ but I left it in just in case...		5 put.data: 5-series	17 4 new: 3-series		3 put.data: 3-series;: FREE.HORN.TUNINGS ( Ñ )	free: 1-series 	free: 5-series	free: 3-series;: RATIO->FREQ {  num den fund -- fHz }	fund float num float f* 	den float f/ 	10.0 f*	F>I				( -- fHz );: STUFF.SERIES { fund series -- }	17  series  set.many: []	17 0  DO		i 1+ 1 fund  ratio->freq 		i series  put: []	LOOP;: ALLOC.DSP.TUNINGS ( Ñ )	17 1 new: dsp-1-series ( freq )		1 put.data: dsp-1-series	17 1 new: dsp-5-series		5 put.data: dsp-5-series	17 1 new: dsp-3-series		3 put.data: dsp-3-series;: FREE.DSP.TUNINGS ( Ñ )	free: dsp-1-series 	free: dsp-5-series	free: dsp-3-series;: FILL.DSP.TUNINGS  { | fund -- }	fundamental-hz @ -> fund	fund dsp-1-series  stuff.series	5 4 fund ratio->freq    ( -- 5/4 of fund )	dsp-3-series  stuff.series	3 2 fund ratio->freq    ( -- 3/2 of fund )	dsp-5-series  stuff.series;: ADJUST.5+3	17 0 DO		i 0 ed.at: 3-series		10 /		i 0 ed.to: 3-series		i 0 ed.at: 5-series		10 /		i 0 ed.to: 5-series	LOOP;: CONFIGURE.TUNING { dsp-series fb-series horn-series -- }	alloc.dsp.tunings	fill.dsp.tunings	17  horn-series  set.many: []	17 0  DO		i 0 dsp-series ed.at: []		i 0 horn-series ed.to: []		i fb-series get: []		i 3 horn-series ed.to: []		i 2 horn-series ed.to: []		i 1 horn-series ed.to: []	LOOP	" Freq "  0  horn-series put.dim.name: []	" Note "  1  horn-series put.dim.name: []	" Fract " 2  horn-series put.dim.name: []	" Cents " 3  horn-series put.dim.name: [];	: CONFIGURE.HORN.TUNINGS  ( Ñ- ) 	dsp-1-series fb-1-series 1-series  configure.tuning	dsp-3-series fb-3-series 3-series  configure.tuning 	dsp-5-series fb-5-series 5-series  configure.tuning;: INIT.HORN.TUNINGS  ( -- )	cr ." Initializing System-wide tunings " cr	." Make sure fundamentals are set for BOTH the DSP and the FB01!!!!" cr cr\	init.dsp.tunings	init.fb.tunings	alloc.horn.tunings	configure.horn.tunings	adjust.5+3;: TERM.HORN.TUNINGS  ( -- )	free.dsp.tunings	free.fb.tunings	free.horn.tunings;if.forgotten term.horn.tunings